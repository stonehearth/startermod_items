#include "radiant.h"
#include "common.h"

using namespace radiant;
using namespace radiant::math3d;

//===============================================================================
// @ point2.cpp
// 
// 3D vector class
// ------------------------------------------------------------------------------
// Copyright (C) 2008 by Elsevier, Inc. All rights reserved.
//
//===============================================================================

//-------------------------------------------------------------------------------
//-- Dependencies ---------------------------------------------------------------
//-------------------------------------------------------------------------------

#include "point2.h"

//-------------------------------------------------------------------------------
//-- Static Members -------------------------------------------------------------
//-------------------------------------------------------------------------------

point2 point2::unit_x(1.0f, 0.0f);
point2 point2::unit_y(0.0f, 1.0f);
point2 point2::origin(0.0f, 0.0f);
point2 point2::xy(1.0f, 1.0f);

//-------------------------------------------------------------------------------
//-- Methods --------------------------------------------------------------------
//-------------------------------------------------------------------------------4444

//-------------------------------------------------------------------------------
// @ operator<<()
//-------------------------------------------------------------------------------
// Text output for debugging
//-------------------------------------------------------------------------------
std::ostream& 
math3d::operator<<(std::ostream& out, const point2& source)
{
    out << '<' << source.x << ',' << source.y << ',' << '>';

    return out;
    
}   // End of operator<<()
    

//-------------------------------------------------------------------------------
// @ point2::length()
//-------------------------------------------------------------------------------
// Vector length
//-------------------------------------------------------------------------------
float 
point2::length() const
{
    return math3d::sqrt(x*x + y*y);

}   // End of point2::length()


//-------------------------------------------------------------------------------
// @ point2::length_squared()
//-------------------------------------------------------------------------------
// Vector length squared (avoids square root)
//-------------------------------------------------------------------------------
float 
point2::length_squared() const
{
    return (x*x + y*y);

}   // End of point2::length_squared()


//-------------------------------------------------------------------------------
// @ point2::operator==()
//-------------------------------------------------------------------------------
// Comparison operator
//-------------------------------------------------------------------------------
bool 
point2::operator==(const point2& other) const
{
    if (::math3d::are_equal(other.x, x)
        && ::math3d::are_equal(other.y, y))
        return true;

    return false;   
}   // End of point2::operator==()


//-------------------------------------------------------------------------------
// @ point2::operator!=()
//-------------------------------------------------------------------------------
// Comparison operator
//-------------------------------------------------------------------------------
bool 
point2::operator!=(const point2& other) const
{
    if (::math3d::are_equal(other.x, x)
        && ::math3d::are_equal(other.y, y))
        return false;

    return true;
}   // End of point2::operator!=()


//-------------------------------------------------------------------------------
// @ vector2math::is_zero()
//-------------------------------------------------------------------------------
// Check for zero vector
//-------------------------------------------------------------------------------
bool 
point2::is_zero() const
{
    return math3d::is_zero(x*x + y*y);

}   // End of vector2math::is_zero()


//-------------------------------------------------------------------------------
// @ point2::clean()
//-------------------------------------------------------------------------------
// Set elements close to zero equal to zero
//-------------------------------------------------------------------------------
void
point2::clean()
{
    if (math3d::is_zero(x))
        x = 0.0f;
    if (math3d::is_zero(y))
        y = 0.0f;

}   // End of point2::clean()


//-------------------------------------------------------------------------------
// @ point2::normalize()
//-------------------------------------------------------------------------------
// Set to unit vector
//-------------------------------------------------------------------------------
void
point2::normalize()
{
    float lengthsq = x*x + y*y;

    if (math3d::is_zero(lengthsq))
    {
        set_zero();
    }
    else
    {
        float factor = math3d::inv_sqrt(lengthsq);
        x *= factor;
        y *= factor;
    }

}   // End of point2::normalize()


//-------------------------------------------------------------------------------
// @ point2::operator+()
//-------------------------------------------------------------------------------
// Add vector to self and return
//-------------------------------------------------------------------------------
point2 
point2::operator+(const point2& other) const
{
    return point2(x + other.x, y + other.y);

}   // End of point2::operator+()


//-------------------------------------------------------------------------------
// @ point2::operator+=()
//-------------------------------------------------------------------------------
// Add vector to self, store in self
//-------------------------------------------------------------------------------
point2& 
operator+=(point2& self, const point2& other)
{
    self.x += other.x;
    self.y += other.y;

    return self;

}   // End of point2::operator+=()


//-------------------------------------------------------------------------------
// @ point2::operator-()
//-------------------------------------------------------------------------------
// Subtract vector from self and return
//-------------------------------------------------------------------------------
point2 
point2::operator-(const point2& other) const
{
    return point2(x - other.x, y - other.y);

}   // End of point2::operator-()


//-------------------------------------------------------------------------------
// @ point2::operator-=()
//-------------------------------------------------------------------------------
// Subtract vector from self, store in self
//-------------------------------------------------------------------------------
point2& 
operator-=(point2& self, const point2& other)
{
    self.x -= other.x;
    self.y -= other.y;

    return self;

}   // End of point2::operator-=()

//-------------------------------------------------------------------------------
// @ point2::operator-() (unary)
//-------------------------------------------------------------------------------
// Negate self and return
//-------------------------------------------------------------------------------
point2
point2::operator-() const
{
    return point2(-x, -y);
}    // End of point2::operator-()


//-------------------------------------------------------------------------------
// @ operator*()
//-------------------------------------------------------------------------------
// Scalar multiplication
//-------------------------------------------------------------------------------
point2   
point2::operator*(float scalar)
{
    return point2(scalar*x, scalar*y);

}   // End of operator*()


//-------------------------------------------------------------------------------
// @ operator*()
//-------------------------------------------------------------------------------
// Scalar multiplication
//-------------------------------------------------------------------------------
point2   
operator*(float scalar, const point2& vector)
{
    return point2(scalar*vector.x, scalar*vector.y);

}   // End of operator*()


//-------------------------------------------------------------------------------
// @ point2::operator*()
//-------------------------------------------------------------------------------
// Scalar multiplication by self
//-------------------------------------------------------------------------------
point2&
point2::operator*=(float scalar)
{
    x *= scalar;
    y *= scalar;

    return *this;

}   // End of point2::operator*=()


//-------------------------------------------------------------------------------
// @ operator/()
//-------------------------------------------------------------------------------
// Scalar division
//-------------------------------------------------------------------------------
point2   
point2::operator/(float scalar)
{
    return point2(x/scalar, y/scalar);

}   // End of operator/()


//-------------------------------------------------------------------------------
// @ point2::operator/=()
//-------------------------------------------------------------------------------
// Scalar division by self
//-------------------------------------------------------------------------------
point2&
point2::operator/=(float scalar)
{
    x /= scalar;
    y /= scalar;

    return *this;

}   // End of point2::operator/=()


//-------------------------------------------------------------------------------
// @ point2::dot()
//-------------------------------------------------------------------------------
// dot product by self
//-------------------------------------------------------------------------------
float               
point2::dot(const point2& vector) const
{
    return (x*vector.x + y*vector.y);

}   // End of point2::dot()


//-------------------------------------------------------------------------------
// @ dot()
//-------------------------------------------------------------------------------
// dot product friend operator
//-------------------------------------------------------------------------------
float               
dot(const point2& vector1, const point2& point2)
{
    return (vector1.x*point2.x + vector1.y*point2.y);

}   // End of dot()


//-------------------------------------------------------------------------------
// @ point2::perp_dot()
//-------------------------------------------------------------------------------
// Perpendicular dot product by self
//-------------------------------------------------------------------------------
float               
point2::perp_dot(const point2& vector) const
{
    return (x*vector.y - y*vector.x);

}   // End of point2::dot()


//-------------------------------------------------------------------------------
// @ dot()
//-------------------------------------------------------------------------------
// dot product friend operator
//-------------------------------------------------------------------------------
float               
perp_dot(const point2& vector1, const point2& point2)
{
    return (vector1.x*point2.y - vector1.y*point2.x);

}   // End of dot()

